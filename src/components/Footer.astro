---
import SocialLinks from "./SocialLinks.astro";
---

<footer class="border-t border-[var(--color-border)] bg-bg-primary py-xl">
  <div class="max-w-prose mx-auto px-[clamp(16px,4vw,48px)]">
    <div class="flex justify-between items-center">
      <SocialLinks />

      <div class="flex items-center gap-md">
        <button
          id="debug-toggle"
          class="p-3 -m-3 text-sm text-text-light hover:text-accent transition-colors"
          aria-label="Toggle debug mode"
          aria-pressed="false"
        >
          DEBUG
        </button>
        <span
          class="clock text-sm text-text-light"
          data-timezone="Europe/Amsterdam"
        ></span>
        <p class="text-sm text-text-light">
          &copy; {new Date().getFullYear()} Richard Lagrand
        </p>
      </div>
    </div>
  </div>
</footer>

<script>
  // Debug toggle
  function toggleDebug() {
    const current = document.documentElement.dataset.debug || 'off';
    const next = current === 'on' ? 'off' : 'on';
    document.documentElement.dataset.debug = next;
    localStorage.setItem('debug-borders', next);
    const btn = document.getElementById('debug-toggle');
    if (btn) btn.setAttribute('aria-pressed', next === 'on' ? 'true' : 'false');
  }

  const debugState = document.documentElement.dataset.debug || 'off';
  document.getElementById('debug-toggle')?.setAttribute('aria-pressed', debugState === 'on' ? 'true' : 'false');
  document.getElementById('debug-toggle')?.addEventListener('click', toggleDebug);

  const clocks = document.querySelectorAll('.clock');
  clocks.forEach((clock) => {
    const tz = (clock as HTMLElement).dataset.timezone || 'UTC';
    const update = () => {
      clock.textContent = new Intl.DateTimeFormat('en-US', {
        timeZone: tz,
        hour: '2-digit',
        minute: '2-digit',
        hour12: false,
      }).format(new Date());
    };
    update();
    setInterval(update, 60000);
  });
</script>

<style>
  footer {
    box-shadow: 0 -1px 3px rgba(0, 0, 0, 0.05);
  }

  [data-theme="dark"] footer {
    box-shadow: 0 -1px 3px rgba(0, 0, 0, 0.3);
  }
</style>
